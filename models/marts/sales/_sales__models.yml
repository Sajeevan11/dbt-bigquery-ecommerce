version: 2

models:
  - name: mart_customer_orders
    description: |
      Customer-level order metrics aggregated from staging orders.
      Includes order counts by status, completion rates, and behavioral segmentation.
    columns:
      - name: user_id
        description: "Unique customer identifier"
        tests:
          - unique
          - not_null
      
      - name: total_orders
        description: "Total number of orders placed by customer"
        tests:
          - not_null
      
      - name: completion_rate
        description: "Percentage of orders completed (0-100)"
        tests:
          - not_null
      
      - name: cancellation_rate
        description: "Percentage of orders cancelled (0-100)"
      
      - name: return_rate
        description: "Percentage of orders returned (0-100)"
      
      - name: first_order_date
        description: "Date of customer's first order"
        tests:
          - not_null
      
      - name: customer_behavior
        description: "Customer behavior classification"
        tests:
          - accepted_values:
              values: ['Mostly Complete', 'High Cancellation', 'High Returns', 'Mixed']
              
  - name: mart_user_behavior
    description: |
      Comprehensive user behavior analysis combining demographics and order metrics.
      Includes user segmentation by age, order activity classification, and complete
      order statistics. Uses LEFT JOIN to include all users, even those who never ordered.
    columns:
      - name: user_id
        description: "Unique user identifier"
        tests:
          - unique
          - not_null
      
      - name: user_email
        description: "User's email address"
        tests:
          - not_null
      
      - name: user_age
        description: "User's age"
        tests:
          - not_null
      
      - name: age_group
        description: "Age segmentation for marketing analysis"
        tests:
          - accepted_values:
              values: ['Young (< 25)', 'Adult (25-34)', 'Middle Age (35-49)', 'Senior (50-64)', 'Elder (65+)']
      
      - name: user_classification
        description: "User activity classification based on order count"
        tests:
          - not_null
          - accepted_values:
              values: ['Never Ordered', 'One-Time Buyer', 'Occasional Buyer', 'Frequent Buyer']
      
      - name: total_orders
        description: "Total number of orders (0 for users who never ordered)"
        tests:
          - not_null
      
      - name: completion_rate
        description: "Percentage of completed orders (0-100)"